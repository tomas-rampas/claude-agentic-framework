# Reader Agent Hook Mappings
# Defines integration points for fast file analysis and information extraction

version: "1.0"
agent: reader-agent

hooks:
  file-analysis-patterns:
    description: "Detects and analyzes file patterns"
    trigger: "on_file_read"
    priority: 1
    actions:
      - name: detect_file_type
        description: "Identify file type and encoding"
        required: true
      - name: analyze_structure
        description: "Extract file structure"
        required: true
        mcp_server: "filesystem"
      - name: extract_metadata
        description: "Get file metadata"
        required: false
      - name: assess_complexity
        description: "Measure file complexity"
        required: false
    config:
      detect_encoding: true
      extract_headers: true
      measure_size: true
      
  data-extraction:
    description: "Extracts structured data from files"
    trigger: "on_data_request"
    priority: 1
    actions:
      - name: parse_json
        description: "Extract JSON data"
        required: false
      - name: parse_yaml
        description: "Extract YAML configuration"
        required: false
      - name: extract_env_vars
        description: "Find environment variables"
        required: true
      - name: detect_secrets
        description: "Scan for potential secrets"
        required: true
    patterns:
      - "API_KEY"
      - "SECRET"
      - "PASSWORD"
      - "TOKEN"
      - "PRIVATE_KEY"
      
  code-exploration:
    description: "Explores code structure and relationships"
    trigger: "on_code_analysis"
    priority: 1
    actions:
      - name: extract_symbols
        description: "Get all symbols"
        required: true
        mcp_server: "serena"
      - name: map_imports
        description: "Track dependencies"
        required: true
      - name: build_hierarchy
        description: "Create class/module hierarchy"
        required: false
        mcp_server: "serena"
      - name: find_entry_points
        description: "Locate main functions"
        required: true
    config:
      include_private: false
      resolve_aliases: true
      track_exports: true
      
  summary-templates:
    description: "Generates formatted summaries"
    trigger: "on_summary_request"
    priority: 2
    actions:
      - name: select_template
        description: "Choose appropriate template"
        required: true
      - name: gather_metrics
        description: "Collect code metrics"
        required: true
      - name: format_output
        description: "Format summary output"
        required: true
      - name: add_visualizations
        description: "Add charts/graphs"
        required: false
    templates:
      - project_overview
      - code_metrics
      - dependency_report
      - security_scan
      - test_coverage
      
  search-strategies:
    description: "Optimizes search operations"
    trigger: "on_search"
    priority: 1
    actions:
      - name: optimize_scope
        description: "Limit search to relevant files"
        required: true
        mcp_server: "filesystem"
      - name: select_algorithm
        description: "Choose search method"
        required: true
      - name: rank_results
        description: "Order by relevance"
        required: true
      - name: apply_filters
        description: "Filter results"
        required: false
    strategies:
      - exact_match
      - fuzzy_search
      - regex_pattern
      - semantic_search
      
  file-format-handlers:
    description: "Handles different file formats"
    trigger: "on_file_open"
    priority: 1
    actions:
      - name: detect_format
        description: "Identify file format"
        required: true
      - name: select_parser
        description: "Choose appropriate parser"
        required: true
      - name: extract_content
        description: "Get file content"
        required: true
        mcp_server: "filesystem"
      - name: handle_errors
        description: "Manage parsing errors"
        required: true
    supported_formats:
      - source_code: [".js", ".py", ".go", ".java"]
      - config: [".json", ".yaml", ".toml", ".ini"]
      - docs: [".md", ".rst", ".txt"]
      - data: [".csv", ".tsv", ".xml"]
      
  content-parsing:
    description: "Parses file content intelligently"
    trigger: "on_content_analysis"
    priority: 2
    actions:
      - name: extract_comments
        description: "Get code comments"
        required: true
      - name: parse_docstrings
        description: "Extract documentation"
        required: true
      - name: process_annotations
        description: "Handle decorators/annotations"
        required: false
      - name: extract_todos
        description: "Find TODO/FIXME comments"
        required: false
    config:
      parse_inline_comments: true
      extract_block_comments: true
      parse_jsdoc: true
      parse_python_docstrings: true
      
# Integration points with other agents
integrations:
  plan-agent:
    - trigger: "on_architecture_analysis"
      action: "provide_project_overview"
      
  maker-agent:
    - trigger: "before_implementation"
      action: "analyze_existing_patterns"
      
  test-agent:
    - trigger: "on_test_discovery"
      action: "find_test_files"
      
  security-agent:
    - trigger: "on_security_scan"
      action: "quick_vulnerability_check"
      
  debug-agent:
    - trigger: "on_log_analysis"
      action: "parse_log_files"
      
  docs-agent:
    - trigger: "on_doc_generation"
      action: "extract_existing_docs"
      
# Performance optimizations
optimizations:
  caching:
    enabled: true
    ttl: 3600
    max_size_mb: 100
    
  parallel_processing:
    enabled: true
    max_workers: 5
    chunk_size: 100
    
  indexing:
    enabled: true
    update_frequency: "on_change"
    index_types: ["symbol", "content", "dependency"]
    
# Quality gates
quality_gates:
  performance:
    - check: "response_time"
      threshold: 5000  # ms
    - check: "memory_usage"
      threshold: 512   # MB
    - check: "files_processed"
      threshold: 0.95  # percentage
      
  accuracy:
    - check: "symbol_resolution"
      threshold: 0.9
    - check: "pattern_matches"
      threshold: 0.95
    - check: "parse_errors"
      threshold: 0.05  # max error rate